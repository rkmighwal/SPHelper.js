/*! sphelper v0.1.0-3 15-02-2017 */
jQuery.cachedScript=function(a,b){return b=jQuery.extend(b||{},{dataType:"script",cache:!0,url:a}),jQuery.ajax(b)};var SPHelper=SPHelper||{};SPHelper.common=function(){"use strict";var a=function(){return window&&window.jQuery}(),b=function(a){a=JSON.stringify(a),console.log(a),alert(a)},c=function(a,c){return jQuery.ajax({url:a,type:"GET",headers:{accept:"application/json;odata=verbose"},success:c,error:b})},d=function(a,b){b||(b=window.location.href),a=a.replace(/[\[\]]/g,"\\$&");var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null},e=function(a,c){b(c.get_message()+"\n"+c.get_stackTrace())},f=function(a,b){var c=864e5,d=a.getTime(),e=b.getTime(),f=e-d;return Math.round(f/c)},g=function(a,b){if("undefined"!=typeof a&&a&&"string"==typeof b&&b){var c=b.split(/\W+/g),d=b,e=(new RegExp(/^\W/g),function(b){var c="",d=["Jan","Feb","Mar","Apr","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];switch(b){case"d":c=a.getDate();break;case"dd":var e=a.getDate();c=e<10?"0"+e:e;break;case"M":c=a.getMonth()+1;break;case"MM":var f=a.getMonth()+1;c=f<10?"0"+f:f;break;case"MMM":c=d[a.getMonth()];break;case"yy":c=String(a.getFullYear()).substring(2);break;case"yyyy":c=a.getFullYear();break;case"h":c=a.getHours();break;case"hh":var g=a.getHours();c=g<10?"0"+g:g;break;case"m":c=a.getMinutes();break;case"mm":var h=a.getMinutes();c=h<10?"0"+_mintues:h;break;case"s":c=a.getSeconds();break;case"ss":var i=a.getSeconds();c=i<10?"0"+i:i;break;default:c=""}return c});if(c.length>0)for(var f=0;f<c.length;f++)d=d.replace(c[f],e(c[f]));return d}return"Invalid Parameter values."};this.isjQueryExists=a(),this.logError=b,this.logErrorJSOM=e,this.sendAJAXCall=c,this.getDaysDifference=f,this.getFormattedDate=g,this.getURLParameterValueByName=d,Object.seal(this),Object.preventExtensions(this)};var SPHelper=SPHelper||{};SPHelper.listItem=function(){"use strict";var a=new SPHelper.common,b="SPHelper.js",c=function(c,d,e,f,g){if(!(a.isjQueryExists&&d&&"undefined"!=typeof g&&null!==g&&jQuery.isFunction(g)))throw new SyntaxError("Invalid Parameters.",b);c=c||_spPageContextInfo.webServerRelativeUrl;var h="/_api/web/lists/GetByTitle('"+d+"')/items"+(e?"("+e+")":""),i=("/"===c?"":c)+h,j=[],k=null,l=function(b){if("undefined"!=typeof b&&null!==b&&null!==b.d.results&&b.d.results.length>0){if(jQuery.each(b.d.results,function(a,b){j.push(b)}),(!k||k&&j.length<parseInt(k))&&b.d.__next&&""!==b.d.__next)return a.sendAJAXCall(b.d.__next,l),!1;k&&(k=parseInt(k),j.length>k&&j.splice(k,j.length-k)),g(j)}else g(null)};null!==f&&"string"==typeof f&&(i+=(0===f.indexOf("?")?"":"?")+f,k=a.getURLParameterValueByName("\\$top",i)),a.sendAJAXCall(i,l)},d=function(a){return a=String(a).replace(/ /g,"_x0020_"),"SP.Data."+a+"ListItem"},e=function(c,e,f,g){if(a.isjQueryExists&&e&&"undefined"!=typeof g&&null!==g&&jQuery.isFunction(g)&&f){c=c||_spPageContextInfo.webServerRelativeUrl;var h=jQuery("#__REQUESTDIGEST").val(),i="/_api/web/lists/GetByTitle('"+e+"')/items",j=("/"===c?"":c)+i;return f.__metadata={type:d(e)},jQuery.ajax({url:j,type:"POST",headers:{accept:"application/json;odata=verbose","content-Type":"application/json;odata=verbose","X-RequestDigest":h},data:JSON.stringify(f),success:g,error:a.logError})}throw new SyntaxError("Invalid Parameters.",b)},f=function(c,d,e,f){if(!(a.isjQueryExists&&d&&"undefined"!=typeof f&&null!==f&&jQuery.isFunction(f)&&e&&jQuery.isArray(e)))throw new SyntaxError("Invalid Parameters.",b);var g=c?new SP.ClientContext(c):new SP.ClientContext.get_current,h=g.get_web().get_lists().getByTitle(d);jQuery.each(e,function(a,b){var c=new SP.ListItemCreationInformation,d=h.addItem(c);for(var e in b)!b.hasOwnProperty(e)||jQuery.isFunction(b[e])||jQuery.isArray(b[e])||d.set_item(e,b[e]);d.update(),g.load(d)}),g.executeQueryAsync(f,Function.createDelegate(this,a.logErrorJSOM))},g=function(e,f,g,h,i){if(!(a.isjQueryExists&&f&&"undefined"!=typeof g&&null!==g&&"undefined"!=typeof i&&null!==i&&jQuery.isFunction(i)&&h))throw new SyntaxError("Invalid Parameters.",b);e=e||_spPageContextInfo.webServerRelativeUrl,h.__metadata={type:d(f)};var j=jQuery("#__REQUESTDIGEST").val(),k=h,l=function(b){jQuery.ajax({url:b.d.__metadata.uri,type:"POST",contentType:"application/json;odata=verbose",data:JSON.stringify(k),headers:{Accept:"application/json;odata=verbose","X-RequestDigest":j,"X-HTTP-Method":"MERGE","If-Match":b.d.__metadata.etag},success:i,error:a.logError})};c(e,f,g,null,l)},h=function(c,d,e,f){if(!(a.isjQueryExists&&d&&"undefined"!=typeof f&&null!==f&&jQuery.isFunction(f)&&e&&jQuery.isArray(e)))throw new SyntaxError("Invalid Parameters.",b);var g=c?new SP.ClientContext(c):new SP.ClientContext.get_current,h=g.get_web().get_lists().getByTitle(d);jQuery.each(e,function(a,b){if(b.hasOwnProperty("ID")&&b.hasOwnProperty("data")&&b.ID&&("number"==typeof b.ID||"string"==typeof b.ID)&&b.data&&jQuery.isArray(b.data)){var c=h.getItemById(parseInt(b.ID).toString()),d=b.data;for(var e in d)!d.hasOwnProperty(e)||jQuery.isFunction(d[e])||jQuery.isArray(d[e])||c.set_item(e,d[e]);c.update()}}),g.executeQueryAsync(f,Function.createDelegate(this,a.logErrorJSOM))},i=function(c,d,e,f){if(!(a.isjQueryExists&&d&&"undefined"!=typeof e&&null!==e&&"undefined"!=typeof f&&null!==f&&jQuery.isFunction(f)))throw new SyntaxError("Invalid Parameters.",b);c=c||_spPageContextInfo.webServerRelativeUrl;var g=jQuery("#__REQUESTDIGEST").val(),h="/_api/web/lists/GetByTitle('"+d+"')/items("+e+")",i=("/"===c?"":c)+h;jQuery.ajax({url:i,type:"POST",contentType:"application/json;odata=verbose",headers:{Accept:"application/json;odata=verbose","X-RequestDigest":g,"X-HTTP-Method":"DELETE","If-Match":"*"},success:f,error:a.logError})},j=function(c,d,e,f){if(!(a.isjQueryExists&&d&&"undefined"!=typeof e&&null!==e&&jQuery.isArray(e)&&"undefined"!=typeof f&&null!==f&&jQuery.isFunction(f)))throw new SyntaxError("Invalid Parameters.",b);for(var g=c?new SP.ClientContext(c):new SP.ClientContext.get_current,h=g.get_web().get_lists().getByTitle(d),i=0;i<e.length;i++){var j=h.getItemById(e[i]);j.deleteObject()}g.executeQueryAsync(f,Function.createDelegate(this,a.logErrorJSOM))};this.getListItem=function(a,d,e,f,g){if(!e||"number"!=typeof e&&"string"!=typeof e)throw new SyntaxError("Invalid ID parameter, it could be String or number.",b);c(a,d,parseInt(e),f,g)},this.getListItems=function(a,b,d,e){c(a,b,null,d,e)},this.saveListItem=e,this.saveListItems=f,this.updateListItem=g,this.updateListItems=h,this.deleteListItem=i,this.deleteListItems=j,Object.seal(this),Object.preventExtensions(this)};var SPHelper=SPHelper||{};SPHelper.list=function(){"use strict";var a=new SPHelper.common,b="SPHelper.js",c=function(c,d,e,f){if(!(a.isjQueryExists&&d&&"undefined"!=typeof f&&null!==f&&jQuery.isFunction(f)))throw new SyntaxError("Invalid Parameters.",b);c=c||_spPageContextInfo.webServerRelativeUrl;var g="/_api/web/lists/GetByTitle('"+d+"')/fields",h=("/"===c?"":c)+g,i=[],j=function(b){if("undefined"!=typeof b&&null!==b&&null!==b.d.results&&b.d.results.length>0){if(jQuery.each(b.d.results,function(a,b){i.push(b)}),b.d.__next&&""!==b.d.__next)return a.sendAJAXCall(b.d.__next,j),!1;f(i)}else f(null)};null!==e&&"string"==typeof e&&(h+=(0===e.indexOf("?")?"":"?")+e),a.sendAJAXCall(h,j)};this.getListFields=c,Object.seal(this),Object.preventExtensions(this)};